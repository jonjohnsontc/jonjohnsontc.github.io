{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/blog/twil-20210821/",
    "result": {"data":{"markdownRemark":{"html":"<p>Too small to be updates in their own right, but I gotta tell somebody! Here's what I learned this past week, ending on 8/21/21.\n<br></br></p>\n<h2 class=\"title\">Profiling Python Applications on a Server</h2>\n<p>In trying to diagnose bottlenecks in a slow running application at work, I learned about different profiling options within Python. For Flask applications, Werkzeug <a href=\"https://werkzeug.palletsprojects.com/en/2.0.x/middleware/profiler/\">provides</a> a <code>ProfilerMiddleware</code>that makes it simple to see which processes are taking the most time. However, because it uses <a href=\"https://docs.python.org/3/library/profile.html#module-cProfile\">cProfile</a> to do the profiling, it doesn't give you any introspection into multithreaded applications in the non-main thread.\n<br></br></p>\n<p>Enabling it is pretty simple. All you need to do is wrap your Flask wsgi instance in the middleware, and any calls you make to the API are automatically returned with a printout of the timing of function calls customized to your liking via the standard library's <code>pstats.Stats</code> interpretation of <a href=\"https://docs.python.org/3/library/profile.html#pstats.Stats.print_stats\">restrictions</a>.\n<br></br></p>\n<p><strong>e.g.,</strong><br></br></p>\n<pre><code class=\"language-python\">from flask import Flask\n\napp = Flask(__name__)\n...\napp.wsgi_app = ProfilerMiddleware(app.wsgi_app, restrictions=[0.05])\n</code></pre>\n<p>Here's where <a href=\"https://pypi.org/project/yappi/\">yappi</a> comes in. It's a library that allows you to profile any multithreaded applications at run simply by running <code>yappi.start()</code> and <code>yappi.stop()</code> to indicate when the profiler should in fact, be running. The best thing is, yappi provides a method to convert its statistical output in <code>pstats.Stats()</code> format, the same used by cProfile.\n<br></br></p>\n<pre><code class=\"language-python\">from flask import current_app, request\nfrom flask_restx import Namespace, Resource\nimport yappi\n\nns = Namepace(\"sprocket-rocket\", description=\"delivering sprockets to kewl users\")\n\n...\n@ns.route(\"/profile\", methods=[\"POST\"])\nclass SprocketProfile(Resource):\n    def post(self) -> dict:\n        data = request.get_json()\n        yappi.start()\n        result = process_sprockets(data)\n        yappi.stop()\n        response = current_app.response_class(\n            response=json.dumps({\"result\": \"upload successful\"}),\n            status=200,\n            mimetype=\"application/json\"\n        )\n        return response\n</code></pre>\n<p>I chose to hack together an endpoint, and start/stop yappi around the process which I wanted to profile.<br></br></p>\n<h2 class=\"title\">Putting Together a Markdown-based Blog with Gatsby</h2>\n<p>Due to creative frustrations, my curiosity pulling me in a thousand directions, and just a lack of vision, I've been putting off the creation of my own website for some time. However, finally deploying my Songwriter Graph <a href=\"https://www.songwritergraph.org\">website</a> I think gave me the encouragement that I needed to get started.\n<br></br>\nI hadn't ever built anything in javascript outside of a couple of automated frontend testing scripts (the songwriter graph is written in clojurescript, as is the UI I contribute to at work), so I wanted my personal site to be a \"gentle\" introduction to the language. After a heated \"eeny meeny...\" session between a few frontend frameworks that specialize in Server Side Rendering (SSR), I decided to roll with making my site in Gatsby (v3 in particular).\n<br></br>\nThe idea of having a personal website / blog, which has pages are written in Markdown has appealed to me since I'd heard of it a few years back. It's surprising just how quickly I was able to get started crafting my own with the combination of <a href=\"https://pages.github.com/\">GitHub Pages</a> and a couple of Gatsby \"plugins\", <code>gatsby-transformer-remark</code> and <code>gatsby-source-filesystem</code>.\n<br></br>\nWithin a few hours, I had built a few React components strewn across some Gatsby pages. One component in particular, named <code>blogTemplate</code> gave me all I needed to start rendering Markdown pages as blog posts:</p>\n<pre><code class=\"language-jsx\">export default function Template({ data }) {\n  const { markdownRemark } = data;\n  const { frontmatter, html } = markdownRemark;\n\n  return (\n    &#x3C;div className={`blog-post-container container`}>\n      &#x3C;div className={`blog-post hero is-medium has-background-grey-darker`}>\n        {/* We render a blank hero-body, and hero-foot with text to \n        give the title at bottom look */}\n        &#x3C;div className={`hero-body`}>&#x3C;/div>\n        &#x3C;div className={`hero-foot`}>\n          &#x3C;p\n            className={`title is-size-1 is-inline has-text-white is-family-sans-serif`}\n          >\n            {frontmatter.title}\n          &#x3C;/p>\n          &#x3C;p className={`pl-6 subtitle is-inline has-text-white`}>\n            {frontmatter.date}\n          &#x3C;/p>\n        &#x3C;/div>\n      &#x3C;/div>\n\n      &#x3C;div\n        className={`blog-post-content mt-6`}\n        dangerouslySetInnerHTML={{ __html: html }}\n      />\n      &#x3C;footer\n        className=\"footer\"\n        children={\n          &#x3C;span className=\"has-text-centered\">\n            ~ Thanks for reading! If you enjoyed it, consider sharing it with\n            someone u like ðŸ’œ ~\n          &#x3C;/span>\n        }\n      />\n    &#x3C;/div>\n  );\n}\n</code></pre>\n<p><br></br>\nHere, <code>Template</code> is a template for an individual post. Coupled with a page to list all of the blog entries, I've got a solution for my website's blog that I can continue to improve upon with time.</p>","frontmatter":{"date":"August 21, 2021","slug":"/blog/twil-20210821/","title":"This Week I Learned - I"}}},"pageContext":{"slug":"/blog/twil-20210821/","id":"8bce7dc6-8795-554c-8310-5c7787c57a0d"}},
    "staticQueryHashes": ["3361508366"]}